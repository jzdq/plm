<script id="ws-js" src="js/jq.js"></script>
<script id="ws-visu">
//--Webtools Visual  plug-end
E=$("body");
$("body").click(function (e) {
//过滤注入组件处理
textid=$(e.target).attr('id');
if(textid=="tagClasses" || textid=="visBox" || textid=="tagName" || textid=="tagWH" || textid=="tagId"|| textid=="visCover"){
return ;
}
E=$(e.target);
iapp.s("sss.i",null);

//传值
nowid ="#"+textid;
if(textid==null){
nowid="";
}

//将页面动画滚动到指定位置
		$('html, body').animate({
			scrollTop: E.offset().top
		},0);

/*标注当前对象属性 绘制边框*/
showB();

//iapp传值
vName=E.get(0).tagName.toLowerCase();

iapp.s("sss.headtag",getHeadLayout());
iapp.s("sss.idCss",getCSS());
iapp.s("sss.intag",getInLayout());
iapp.s("sss.nowid",nowid);
iapp.s("sss.layoutid",nowid);
iapp.s("sss.tagname",vName);
iapp.s("sss.tagText",getTagText());
iapp.s("sss.tagHtml",E.html());
iapp.s("sss.idParent","#"+E.parent().attr("id"));
iapp.s("sss.childLength",E.children().length);
iapp.s("sss.idAttr",getAttr());
iapp.s("sss.idHtml",getHtml());
//网站属性
htmlcode=sj($("html").prop("outerHTML"),null,'<script id="ws-js"')+"</body>\n</html>";
htmlcode=htmlcode.replace(new RegExp('(<[A-Za-z0-9].*?)\n[\t]*</',"g"),"$1</");
iapp.s("sss.docHtmlCode", htmlcode);
iapp.s("sss.docTitle", $(document).attr('title'));
iapp.s("sss.docKeywords", $("meta[name='keywords']").attr("content"));
iapp.s("sss.docDescription", $("meta[name='description']").attr("content"));
iapp.s("sss.i","OK");
});


//获取当前元素html
function getHtml(){
  idHtml=E.prop("outerHTML");
  if(E.get(0).tagName.toLowerCase()=="body"){
  idHtml=sj(idHtml,null,'<script id="ws-js"')+"</body>";  
  }
  return idHtml.replace(/\n\n/g,"\n").replace(/\n\n/g,"\n");
 }



//--标注当前对象属性 绘制边框
function showB(){
$("#visBox").css('display', "block");
var y = E.offset().top;
var x=E.offset().left;
var h=E[0].getBoundingClientRect().height;
var w=E[0].getBoundingClientRect().width;
var selfh=$("#visBox")[0].getBoundingClientRect().height;
$("#visBox").css('left', x+1);
if(y<selfh)
{
$("#visBox").css('top', y+1);
}else{
$("#visBox").css('top', y-selfh);
}
$("#visCover").css('top', y);
$("#visCover").css('width', w);
$("#visCover").css('height', h);
$("#visCover").css('left', x);
$("#tagName").text(E.get(0).tagName.toLowerCase());
$("#tagId").text(nowid);
$("#tagWH").text(parseInt(w)+"*"+parseInt(h));
if(E.attr('class')==null){
$("#tagClasses").text("");
}else{
$("#tagClasses").text(E.attr('class'));
}

vName=E.get(0).tagName.toLowerCase();
iapp.s("sss.headtag",getHeadLayout());
iapp.s("sss.idCss",getCSS());
iapp.s("sss.intag",getInLayout());
iapp.s("sss.nowid",nowid);
iapp.s("sss.layoutid",nowid);
iapp.s("sss.tagname",vName);
iapp.s("sss.tagText",getTagText());
iapp.s("sss.tagHtml",E.html());
iapp.s("sss.idParent","#"+E.parent().attr("id"));
iapp.s("sss.childLength",E.children().length);
iapp.s("sss.idAttr",getAttr());
iapp.s("sss.idHtml",getHtml());
//网站属性
htmlcode=sj($("html").prop("outerHTML"),null,'<script id="ws-js"')+"</body>\n</html>";
htmlcode=htmlcode.replace(new RegExp('(<[A-Za-z0-9].*?)\n[\t]*</',"g"),"$1</");
iapp.s("sss.docHtmlCode", htmlcode);
iapp.s("sss.docTitle", $(document).attr('title'));
iapp.s("sss.docKeywords", $("meta[name='keywords']").attr("content"));
iapp.s("sss.docDescription", $("meta[name='description']").attr("content"));
}


//--获取控件文本内容
function getTagText(){
  var text;
  if(vName=="body"){
   text=sj(E.text(),null,"//--Webtools Visual  plug-end");
  }else{
   text=E.text();
  }
  return text.replace(/\n[	]*\n/g,"\n").replace(/\n[	]*\n/g,"\n");
}




//--获取css
function getCSS(){
if(E.attr("style")==null){return "";}
return E.attr("style").split(";").join("\n");
}



//--格式化html
function format(strs) {
      return strs;
    }
    




//--添加元素-判断
function  addElement(type,htmlCode){
 switch(type) {
  case 0:
  addElementAi(htmlCode);
    break;
  case 1:
  addElementSon(htmlCode);
    break;
  case 2:
   addElementAfter(htmlCode);
    break;
  case 3:
   addElementBefore(htmlCode);
    break;
  case 4:
   addElementAi(htmlCode);
    break;
   }
}

//--添加元素-ai添加
function  addElementAi(htmlCode){
    //--同级控件-后
   var newTag=$(htmlCode);
   var tagName=E.get(0).tagName;
   var allowTags=";INPUT;IMG;P;HR;BUTTON;H1;H2;H3;H4;H5;H6;";
   if(allowTags.indexOf(";"+tagName+";")!=-1){
       E=E.parent();
     }
   //--添加控件子
   if(E.get(0).tagName=="BODY"){
     $("#ws-js").before(newTag);
     }else{
      E.append(newTag);
     }
    E=newTag;
    E.click();
 }


//--添加元素-子控件添加
function  addElementSon(htmlCode){
    //--子控件-后
    var newTag=$(htmlCode);
    //--添加控件
       if(E.get(0).tagName=="BODY"){
     $("#ws-js").before(newTag);
     }else{
      E.append(newTag);
     }
    E.click();
 }
 
//--添加元素-同级后添加
function  addElementAfter(htmlCode){
    //--同级控件-后
    if(E.get(0).tagName!="BODY"){
    var newTag=$(htmlCode);
    //--添加控件
    E.after(newTag);
    E=newTag;
    E.click();
     }
 }
 
 
//--添加元素-同级前添加
function  addElementBefore(htmlCode){
    //--同级控件-前
    if(E.get(0).tagName!="BODY"){
    var newTag=$(htmlCode);
